# 데이터 수집 파이프라인 다이어그램

## 전체 데이터 흐름도

```
┌─────────────────────────────────────────────────────────────────────┐
│                         데이터 소스 (Data Sources)                     │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐            │
│  │   특허 DB    │  │   논문 DB    │  │   뉴스 사이트 │            │
│  ├──────────────┤  ├──────────────┤  ├──────────────┤            │
│  │ USPTO        │  │ arXiv        │  │ SK하이닉스   │            │
│  │ PatentView   │  │ Semantic     │  │ 뉴스룸       │            │
│  │ Google       │  │ Scholar      │  │              │            │
│  │ Patents      │  │ PubMed       │  │ 삼성전자     │            │
│  │              │  │ IEEE Xplore  │  │ 뉴스룸       │            │
│  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘            │
│         │                 │                 │                     │
└─────────┼─────────────────┼─────────────────┼─────────────────────┘
          │                 │                 │
          ▼                 ▼                 ▼
┌─────────────────────────────────────────────────────────────────────┐
│                      데이터 수집 계층 (Collection)                     │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  ┌─────────────────────┐  ┌──────────────────┐  ┌──────────────┐  │
│  │ collect_patents.py  │  │ collect_papers.py│  │ Selenium     │  │
│  ├─────────────────────┤  ├──────────────────┤  │ Scrapers     │  │
│  │ • PatentView API   │  │ • arXiv API      │  ├──────────────┤  │
│  │ • 키워드 검색       │  │ • S2 API         │  │ 00_1_*.ipynb │  │
│  │ • 페이지네이션     │  │ • 카테고리 필터  │  │ 00_2_*.ipynb │  │
│  │ • 중복 제거        │  │ • 메타데이터     │  │              │  │
│  └─────────┬───────────┘  └─────────┬────────┘  └──────┬───────┘  │
│            │                        │                  │           │
└────────────┼────────────────────────┼──────────────────┼───────────┘
             │                        │                  │
             ▼                        ▼                  ▼
┌─────────────────────────────────────────────────────────────────────┐
│                        원본 데이터 (Raw Data)                         │
├─────────────────────────────────────────────────────────────────────┤
│  data/raw/                                                          │
│  ┌──────────────────────┐  ┌──────────────────┐  ┌──────────────┐ │
│  │ HBM/                 │  │ papers_*.jsonl   │  │ skhynix_     │ │
│  │ ├─ HBM_Gemini.csv   │  │ papers_*.csv     │  │ news.csv     │ │
│  │ ├─ *_Applicant.csv  │  │                  │  │              │ │
│  │ ├─ *_Inventor.csv   │  │                  │  │ samsung_     │ │
│  │ ├─ *_Abstract.csv   │  │                  │  │ news.csv     │ │
│  │ └─ ...              │  │                  │  │              │ │
│  └──────────┬───────────┘  └─────────┬────────┘  └──────┬───────┘ │
│             │                        │                  │          │
└─────────────┼────────────────────────┼──────────────────┼──────────┘
              │                        │                  │
              ▼                        ▼                  ▼
┌─────────────────────────────────────────────────────────────────────┐
│                      데이터 로딩 (Data Loading)                       │
├─────────────────────────────────────────────────────────────────────┤
│  src/data/loaders.py                                                │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │ • load_csv() - CSV 로딩                                      │   │
│  │ • load_csv_safe() - 인코딩 안전 로딩                         │   │
│  │ • list_patent_files() - 파일 목록                            │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                             │                                       │
└─────────────────────────────┼───────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────────┐
│                    데이터 전처리 (Preprocessing)                      │
├─────────────────────────────────────────────────────────────────────┤
│  data/interim/                                                      │
│  ┌────────────────────────────────────────────────────────────┐    │
│  │ • 데이터 정제 (Cleaning)                                    │    │
│  │ • 결측치 처리 (Missing values)                              │    │
│  │ • 중복 제거 (Deduplication)                                 │    │
│  │ • 날짜 정규화 (Date normalization)                          │    │
│  │ • 텍스트 정규화 (Text normalization)                        │    │
│  └────────────────────────────────────────────────────────────┘    │
│                             │                                       │
└─────────────────────────────┼───────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────────┐
│                  특징 엔지니어링 (Feature Engineering)                │
├─────────────────────────────────────────────────────────────────────┤
│  src/features/                                                      │
│  ┌────────────────────────────────────────────────────────────┐    │
│  │ text.py                                                     │    │
│  │ • 텍스트 임베딩 (BERT, Sentence-Transformers)              │    │
│  │ • 키워드 추출                                              │    │
│  │ • 토픽 모델링 준비                                         │    │
│  └────────────────────────────────────────────────────────────┘    │
│                             │                                       │
└─────────────────────────────┼───────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────────┐
│                    분석 준비 데이터 (Processed Data)                  │
├─────────────────────────────────────────────────────────────────────┤
│  data/processed/                                                    │
│  ┌────────────────────────────────────────────────────────────┐    │
│  │ • 모델 학습용 데이터                                        │    │
│  │ • 분석 준비 완료 데이터                                     │    │
│  │ • 임베딩 벡터                                               │    │
│  └────────────────────────────────────────────────────────────┘    │
│                             │                                       │
└─────────────────────────────┼───────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────────┐
│                         분석 계층 (Analysis)                         │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  ┌─────────────────┐  ┌──────────────┐  ┌──────────────────────┐  │
│  │ BERTopic        │  │ SNA          │  │ LLM Augmented        │  │
│  ├─────────────────┤  ├──────────────┤  ├──────────────────────┤  │
│  │ 동적 토픽 모델링 │  │ 네트워크 분석│  │ 맥락 해석            │  │
│  │ • 시계열 추적   │  │ • Co-occur   │  │ • Weak Signal        │  │
│  │ • 토픽 진화     │  │ • Centrality │  │ • Contextualization  │  │
│  └─────────────────┘  └──────────────┘  └──────────────────────┘  │
│           │                    │                     │              │
│           └────────────────────┼─────────────────────┘              │
│                                ▼                                    │
└────────────────────────────────────────────────────────────────────┘
                                 │
                                 ▼
┌─────────────────────────────────────────────────────────────────────┐
│                      결과물 (Outputs & Reports)                      │
├─────────────────────────────────────────────────────────────────────┤
│  reports/                                                           │
│  ┌────────────────────────────────────────────────────────────┐    │
│  │ • research_paper_v2.md                                     │    │
│  │ • 시각화 (figures/)                                        │    │
│  │ • 통계 리포트                                              │    │
│  └────────────────────────────────────────────────────────────┘    │
│                                                                     │
│  notebooks/                                                         │
│  ┌────────────────────────────────────────────────────────────┐    │
│  │ • 01_exploration.ipynb                                     │    │
│  │ • 02_advanced_analysis.ipynb                               │    │
│  │ • 03_forecasting.ipynb                                     │    │
│  │ • 04_patent_analysis.ipynb                                 │    │
│  │ • 05_temporal_network_analysis.ipynb                       │    │
│  └────────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 현재 구현 상태 (Current vs. Planned)

### ✅ 현재 구현됨 (Green Path)
```
뉴스 데이터:
    Selenium Scrapers → CSV → loaders.py → Analysis

특허 데이터 (수동):
    Gemini DB (수동 다운로드) → CSV → loaders.py → 04_patent_analysis.ipynb
```

### ⚠️ 부분 구현 (Yellow Path)
```
특허 데이터 (자동화 필요):
    API 연동 없음 → 자동 업데이트 불가
```

### ❌ 미구현 (Red Path)
```
논문 데이터:
    [소스 없음] → [수집 스크립트 없음] → [데이터 없음] → [분석 불가]
```

---

## 제안된 개선 파이프라인 (Proposed Pipeline)

```
┌────────────────────────────────────────────────────────────┐
│                 자동화 트리거 (Automation Triggers)          │
├────────────────────────────────────────────────────────────┤
│                                                            │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐       │
│  │ GitHub      │  │ Cron Job    │  │ Manual      │       │
│  │ Actions     │  │ (Weekly)    │  │ Execution   │       │
│  │ (Schedule)  │  │             │  │             │       │
│  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘       │
│         │                │                │              │
└─────────┼────────────────┼────────────────┼──────────────┘
          │                │                │
          └────────────────┼────────────────┘
                           │
                           ▼
┌────────────────────────────────────────────────────────────┐
│              통합 수집 스크립트 (Unified Collector)          │
├────────────────────────────────────────────────────────────┤
│  scripts/                                                  │
│  ┌──────────────────────────────────────────────────┐     │
│  │ collect_all.py (Master Script)                   │     │
│  │ ├─ collect_patents.py                            │     │
│  │ ├─ collect_papers.py                             │     │
│  │ ├─ collect_news.py                               │     │
│  │ └─ incremental_update.py (증분 업데이트)          │     │
│  └──────────────────────────────────────────────────┘     │
│                           │                                │
└───────────────────────────┼────────────────────────────────┘
                            │
                            ▼
┌────────────────────────────────────────────────────────────┐
│                 데이터 검증 (Data Validation)               │
├────────────────────────────────────────────────────────────┤
│  src/data/validator.py                                     │
│  ┌──────────────────────────────────────────────────┐     │
│  │ • 중복 확인                                       │     │
│  │ • 필수 필드 검증                                  │     │
│  │ • 날짜 형식 검증                                  │     │
│  │ • 품질 리포트 생성                                │     │
│  └──────────────────────────────────────────────────┘     │
│                           │                                │
└───────────────────────────┼────────────────────────────────┘
                            │
                            ▼
┌────────────────────────────────────────────────────────────┐
│              자동 커밋 & 푸시 (Auto Commit & Push)          │
├────────────────────────────────────────────────────────────┤
│  ┌──────────────────────────────────────────────────┐     │
│  │ git add data/raw/                                │     │
│  │ git commit -m "Auto-update: data collection"    │     │
│  │ git push origin main                             │     │
│  └──────────────────────────────────────────────────┘     │
└────────────────────────────────────────────────────────────┘
```

---

## 데이터 흐름 상세 (Data Flow Details)

### 1. 특허 데이터 흐름
```
┌──────────────┐
│ PatentView   │ API Request (POST)
│ API          │ ← {"q": {"_text_any": {"patent_abstract": "HBM"}}}
└──────┬───────┘
       │ JSON Response
       ▼
┌──────────────────────────────────────────┐
│ collect_patents.py                       │
│ ┌────────────────────────────────────┐   │
│ │ 1. 페이지네이션 처리                 │   │
│ │    for page in range(1, max_pages) │   │
│ │                                    │   │
│ │ 2. 데이터 파싱                      │   │
│ │    patent_number, title, abstract  │   │
│ │                                    │   │
│ │ 3. DataFrame 생성                   │   │
│ │    pd.DataFrame(patents)           │   │
│ │                                    │   │
│ │ 4. 중복 제거                        │   │
│ │    drop_duplicates('patent_number')│   │
│ └────────────────────────────────────┘   │
└──────┬───────────────────────────────────┘
       │ CSV File
       ▼
┌──────────────────────────┐
│ data/raw/HBM/            │
│ HBM_PatentView_*.csv     │
└──────┬───────────────────┘
       │
       ▼
┌──────────────────────────┐
│ 04_patent_analysis.ipynb │
│ • Applicant Analysis     │
│ • Inventor Ranking       │
│ • Tech Classification    │
│ • Impact Metrics         │
│ • Text Mining            │
└──────────────────────────┘
```

### 2. 논문 데이터 흐름 (제안)
```
┌──────────────┐
│ arXiv API    │ HTTP GET
│              │ ← query="HBM", max_results=100
└──────┬───────┘
       │ XML/JSON Response
       ▼
┌──────────────────────────────────────────┐
│ collect_papers.py                        │
│ ┌────────────────────────────────────┐   │
│ │ 1. 검색 쿼리 구성                   │   │
│ │    arxiv.Search(query, categories) │   │
│ │                                    │   │
│ │ 2. 결과 수집                        │   │
│ │    for result in search.results()  │   │
│ │                                    │   │
│ │ 3. 메타데이터 추출                  │   │
│ │    title, abstract, authors, date  │   │
│ │                                    │   │
│ │ 4. DataFrame 생성 및 저장           │   │
│ │    to_csv() / to_jsonl()           │   │
│ └────────────────────────────────────┘   │
└──────┬───────────────────────────────────┘
       │ CSV + JSONL
       ▼
┌──────────────────────────┐
│ data/raw/                │
│ papers_HBM_arxiv_*.csv   │
│ papers_HBM_arxiv_*.jsonl │
└──────┬───────────────────┘
       │
       ▼
┌──────────────────────────┐
│ (New Notebook)           │
│ 06_paper_analysis.ipynb  │
│ • Publication Trends     │
│ • Author Networks        │
│ • Citation Analysis      │
│ • Topic Evolution        │
└──────────────────────────┘
```

### 3. 교차 분석 흐름 (Cross-Analysis)
```
┌──────────────┐   ┌──────────────┐   ┌──────────────┐
│  특허 데이터  │   │  논문 데이터  │   │  뉴스 데이터  │
└──────┬───────┘   └──────┬───────┘   └──────┬───────┘
       │                  │                  │
       └──────────────────┼──────────────────┘
                          ▼
       ┌───────────────────────────────────┐
       │  통합 분석 (Integrated Analysis)   │
       ├───────────────────────────────────┤
       │ • 특허-논문 인용 관계               │
       │ • 산학 연계 네트워크               │
       │ • 기술 확산 시차 분석              │
       │ • 트렌드 예측                     │
       └──────────┬────────────────────────┘
                  │
                  ▼
       ┌───────────────────────────────────┐
       │  AI 증강 분석 (LLM Augmented)     │
       ├───────────────────────────────────┤
       │ • Weak Signal Detection           │
       │ • Contextual Reasoning            │
       │ • Trend Forecasting               │
       └──────────┬────────────────────────┘
                  │
                  ▼
       ┌───────────────────────────────────┐
       │  최종 리포트                       │
       │  research_paper_v3.md             │
       └───────────────────────────────────┘
```

---

## 시스템 아키텍처 (System Architecture)

```
┌─────────────────────────────────────────────────────────────┐
│                     Configuration Layer                     │
│  configs/                                                   │
│  ├─ patent_collection.yaml                                 │
│  ├─ paper_collection.yaml                                  │
│  └─ pipeline_config.yaml                                   │
└─────────────────────────────────────────────────────────────┘
                           ▲
                           │ Config
                           │
┌─────────────────────────────────────────────────────────────┐
│                     Orchestration Layer                     │
│  scripts/                                                   │
│  ├─ collect_all.py (Master)                                │
│  ├─ incremental_update.py                                  │
│  └─ schedule_jobs.py                                       │
└─────────────────────────────────────────────────────────────┘
                           ▲
                           │ Commands
                           │
┌─────────────────────────────────────────────────────────────┐
│                      Collection Layer                       │
│  scripts/                                                   │
│  ├─ collect_patents.py                                     │
│  ├─ collect_papers.py                                      │
│  └─ collect_news.py                                        │
└─────────────────────────────────────────────────────────────┘
                           ▲
                           │ Raw Data
                           │
┌─────────────────────────────────────────────────────────────┐
│                        Data Layer                           │
│  src/data/                                                  │
│  ├─ loaders.py                                             │
│  ├─ validator.py                                           │
│  └─ preprocessor.py                                        │
└─────────────────────────────────────────────────────────────┘
                           ▲
                           │ Processed Data
                           │
┌─────────────────────────────────────────────────────────────┐
│                      Feature Layer                          │
│  src/features/                                              │
│  ├─ text.py (Embeddings, Tokenization)                    │
│  └─ network.py (Graph Features)                            │
└─────────────────────────────────────────────────────────────┘
                           ▲
                           │ Features
                           │
┌─────────────────────────────────────────────────────────────┐
│                       Model Layer                           │
│  src/models/                                                │
│  ├─ topic_model.py (BERTopic)                             │
│  ├─ network_analysis.py (SNA)                             │
│  └─ llm_analyzer.py (GPT)                                 │
└─────────────────────────────────────────────────────────────┘
                           ▲
                           │ Insights
                           │
┌─────────────────────────────────────────────────────────────┐
│                    Visualization Layer                      │
│  src/visualization/                                         │
│  └─ plots.py                                               │
└─────────────────────────────────────────────────────────────┘
                           ▲
                           │ Outputs
                           │
┌─────────────────────────────────────────────────────────────┐
│                      Presentation Layer                     │
│  notebooks/ & reports/                                      │
│  • Jupyter Notebooks                                       │
│  • Markdown Reports                                        │
│  • Interactive Dashboards (Future)                         │
└─────────────────────────────────────────────────────────────┘
```

---

## 시간선 다이어그램 (Timeline Diagram)

### 데이터 수집 시간선
```
2020 ────────── 2021 ────────── 2022 ────────── 2023 ────────── 2024
  │              │              │              │              │
  │              │              │              │              │
특허│──────────────┼──────────────┼──────────────┼──────────────┼───▶ 계속
HBM│   ███████    │   ████████   │   ███████    │   ██████████  │
출원│              │              │              │              │
  │              │              │              │              │
논문│──────────────┼──────────────┼──────────────┼──────────────┼───▶ 수집 필요
arXiv             │              │              │              │
  │              │              │              │     ████████  │
뉴스│──────────────┼──────────────┼──────────────┼──────────────┼───▶ 수집 완료
  │   ████████    │   █████████  │   ██████████ │   ███████████ │
  │              │              │              │              │
  └──────────────┴──────────────┴──────────────┴──────────────┴────
                                               2023년 HBM 급증
                                               (AI Boom)
```

---

## 데이터 품질 관리 흐름

```
┌─────────────────────┐
│ Raw Data Collection │
└──────────┬──────────┘
           │
           ▼
┌─────────────────────┐
│ Validation Check    │
├─────────────────────┤
│ ✓ Schema validation │
│ ✓ Duplicate check   │
│ ✓ Missing values    │
│ ✓ Date format       │
└──────────┬──────────┘
           │
           ├─── Pass ──▶ Store in data/raw/
           │
           └─── Fail ──▶ ┌──────────────────┐
                         │ Error Log        │
                         │ • Timestamp      │
                         │ • Error Type     │
                         │ • Record Details │
                         └──────────────────┘
                                 │
                                 ▼
                         ┌──────────────────┐
                         │ Alert/Notify     │
                         │ • Email          │
                         │ • Slack          │
                         │ • Log File       │
                         └──────────────────┘
```

---

이 다이어그램들은 현재 시스템의 구조와 개선 방향을 시각적으로 보여줍니다.
